!function i(a,o,n){function s(t,e){if(!o[t]){if(!a[t]){var r="function"==typeof require&&require;if(!e&&r)return r(t,!0);if(l)return l(t,!0);throw(r=new Error("Cannot find module '"+t+"'")).code="MODULE_NOT_FOUND",r}r=o[t]={exports:{}},a[t][0].call(r.exports,function(e){return s(a[t][1][e]||e)},r,r.exports,i,a,o,n)}return o[t].exports}for(var l="function"==typeof require&&require,e=0;e<n.length;e++)s(n[e]);return s}({1:[function(e,t,r){"use strict";jQuery(document).ready(function(){jQuery("#bookingForm");var l,p,u,d,c,m,v,r=jQuery("#bookingForm").data("url"),i=jQuery("#tourSelect"),a=jQuery("#departureGroup"),g=jQuery("#departureList"),y=jQuery("#departureInfo"),f=jQuery("#departureNotices"),b=jQuery("#pillionFriendly"),h=jQuery("#tripPriceInfo"),x=jQuery("#mainGuestExtras"),j=jQuery("#additionalGuests"),Q=jQuery("#guestFormNotices"),R=jQuery("#addGuest"),_=jQuery("#formNextSubmit"),E={style:"currency",currency:"GBP"},L=jQuery("#bookedItems");i.change(function(){y.css("display","none"),a.css("display","none"),f.html("");var t=i.val(),e={tripId:t,action:"update_form"};jQuery.ajax({type:"POST",url:r,data:e}).done(function(e){var e=JSON.parse(e),n=e.Departures,s=e.PillonFriendly;g.html('<option value="">Select Departure Date...</option>'),n.forEach(function(e){var t=new Date(e["@attributes"].startDate),r=new Date(e["@attributes"].endDate),i=e["@attributes"].id;c="0"===e["@attributes"].availableSpaces?"SOLD OUT":e["@attributes"].availableSpaces,g.append(jQuery("<option>",{value:i,text:t.toDateString()+" to "+r.toDateString()+" - Spots Left: "+c}))}),""===t?a.css("display","none"):a.css("display","block"),g.change(function(){h.html(""),f.html(""),x.html(""),j.html(""),Q.html(""),R.html(""),y.css("display","none"),_.css("display","inline"),L.html("");var i=g.val();function e(r,e){switch(e){case"pillion":console.log("This is a pillion!"),n.forEach(function(e){var t;e["@attributes"].id===i&&(l=e.Prices.Price,t=1,l.forEach(function(e){"Pillion Base Price"!=e["@attributes"].category&&"Rider Base Price"!=e["@attributes"].category&&"Motorcycle Upgrade"!=e["@attributes"].category&&"Damage Excess Insurance"!=e["@attributes"].category&&"SRS - Rider"!=e["@attributes"].name&&(console.log(e["@attributes"].category+": "+e["@attributes"].name+" - "+e["@attributes"].amount),jQuery("#guestExtras"+r).append('<div class="extras-box"><input type="hidden" name="p15_guests.contact.'+r+".p15_vendorserviceitemres."+t+'" value="'+e["@attributes"].id+'"><input class="booking-extra" type="checkbox" name="p15_guests.contact.'+r+".p15_tripprices."+t+'" value="'+e["@attributes"].id+'" data-price="'+e["@attributes"].amount+'" data-price-name="'+e["@attributes"].name+'" data-price-id="'+e["@attributes"].id+'"> '+e["@attributes"].name+": "+new Number(e["@attributes"].amount).toLocaleString("en-GB",E)+"</div>"),t++),"Pillion Base Price"===e["@attributes"].category&&(jQuery(".rider-form").attr("data-price-id",""+e["@attributes"].id),jQuery(".pillion-form").attr("data-price-name",""+e["@attributes"].name),jQuery(".pillion-form").attr("data-price",""+e["@attributes"].amount))}))});break;case"rider":console.log("This is a rider!"),n.forEach(function(e){var t;e["@attributes"].id===i&&(l=e.Prices.Price,t=1,l.forEach(function(e){"Pillion Base Price"!=e["@attributes"].category&&"Rider Base Price"!=e["@attributes"].category&&"SRS - Pillion"!=e["@attributes"].name&&(console.log(e["@attributes"].category+": "+e["@attributes"].name+" - "+e["@attributes"].amount),jQuery("#guestExtras"+r).append('<div class="extras-box"><input type="hidden" name="p15_guests.contact.'+r+".p15_vendorserviceitemres."+t+'" value="'+e["@attributes"].id+'"><input class="booking-extra" type="checkbox" name="p15_guests.contact.'+r+".p15_tripprices."+t+'" value="'+e["@attributes"].id+'" data-price="'+e["@attributes"].amount+'" data-price-name="'+e["@attributes"].name+'" data-price-id="'+e["@attributes"].id+'"> '+e["@attributes"].name+": "+new Number(e["@attributes"].amount).toLocaleString("en-GB",E)+"</div>"),t++),"Rider Base Price"===e["@attributes"].category&&(jQuery(".rider-form").attr("data-price-id",""+e["@attributes"].id),jQuery(".rider-form").attr("data-price-name",""+e["@attributes"].name),jQuery(".rider-form").attr("data-price",""+e["@attributes"].amount))}))})}}function t(){var e=jQuery(".rider-form"),t=(e.length,jQuery(".pillion-form")),a=(t.length,jQuery(".bookingItem").text(),jQuery("#bookedItems")),o=jQuery("#bookingTotal"),n=0;function r(e){var t,r,i;0<e.length&&(t=e.length,i=parseInt(e.attr("data-price")),r=e.attr("data-price-name"),e.attr("data-price-id"),i=i*t,a.append('<tr>\t\n\t\t\t\t\t\t\t\t\t<td class="bookingItem" style="width: 60%;">'.concat(r,'</td>\n\t\t\t\t\t\t\t\t\t<td class="bookingQty" style="width: 15%; text-align: center;">').concat(t,'</td>\n\t\t\t\t\t\t\t\t\t<td class="bookingAmt" style="width: 25%; text-align: right;">').concat(new Number(i).toLocaleString("en-GB",E),"</td>\n\t\t\t\t\t\t\t\t</tr>")),n+=i,o.text(new Number(n).toLocaleString("en-GB",E)))}a.html(""),r(e),r(t),jQuery(".booking-extra:checkbox:checked").each(function(){var e=jQuery(this).attr("data-price-name"),t=jQuery(this).attr("data-price");console.log(e+": "+t),a.append('<tr>\t\n\t\t\t\t\t\t\t\t<td class="bookingItem" style="width: 60%;">'.concat(e,'</td>\n\t\t\t\t\t\t\t\t<td class="bookingQty" style="width: 15%; text-align: center;">1</td>\n\t\t\t\t\t\t\t\t<td class="bookingAmt" style="width: 25%; text-align: right;">').concat(new Number(t).toLocaleString("en-GB",E),"</td>\n\t\t\t\t\t\t\t</tr>"))})}jQuery("input[name=departure_guid]").val(i),n.forEach(function(e){if(e["@attributes"].id===i){if(c=parseInt(e["@attributes"].availableSpaces),jQuery("#availableSpaces").text(c),0===c)return y.css("display","none"),_.css("display","none"),void f.html('<div class="p15-message p15-message-error">Sorry, this date is sold out. Please select another date or send us an email to enquire about cancellations for this date.</div>');l=e.Prices.Price;var r=1;l.forEach(function(e){var t;"Rider Base Price"===e["@attributes"].category&&(p=e["@attributes"].amount,u=e["@attributes"].name,d=e["@attributes"].id,h.append('<p><b>Rider Price:</b> <span id="riderPrice">'+new Number(p).toLocaleString("en-GB",E)+"</span></p>"),jQuery("#bookedRiderPrice").val(d),jQuery(".rider-form").attr("data-price",p),jQuery(".rider-form").attr("data-price-name",u),jQuery(".rider-form").attr("data-price-id",d)),"Pillion Base Price"===e["@attributes"].category&&(t=e["@attributes"].amount,h.append('<p><b>Pillion Price:</b> <span id="pillionPrice">'+new Number(t).toLocaleString("en-GB",E)+"</span></p>")),"Pillion Base Price"!=e["@attributes"].category&&"Rider Base Price"!=e["@attributes"].category&&"SRS - Pillion"!=e["@attributes"].name&&(console.log(e["@attributes"].category+": "+e["@attributes"].name+" - "+e["@attributes"].amount),x.append('<div class="extras-box"><input type="hidden" name="p15_guests.contact.1.p15_vendorserviceitemres.'+r+'" value="'+e["@attributes"].id+'"><input class="booking-extra" type="checkbox" value="'+e["@attributes"].id+'" name="'+r+'" data-price="'+e["@attributes"].amount+'" data-price-name="'+e["@attributes"].name+'" data-price-id="'+e["@attributes"].id+'"> '+e["@attributes"].name+": "+new Number(e["@attributes"].amount).toLocaleString("en-GB",E)+"</div>"),r++)}),t()}}),b.text(s);var r,a=jQuery('input[type="checkbox"]');function o(){a.click(function(){t()})}o(),"Yes"===s&&1<c?(R.html('<button class="p15-btn" type="button" id="addRider"><i class="fas fa-plus-square" style="margin-right:0.25rem;"></i> Add Rider</button><button class="p15-btn" type="button" id="addPillion"><i class="fas fa-plus-square" style="margin-right:0.25rem;"></i> Add Pillon</button>'),m=jQuery("#addRider"),v=jQuery("#addPillion"),r=2,m.click(function(){r<=c&&(console.log("Counter: "+r+". Spots Left: "+c),j.append('<div id="guest'+r+'" class="guest-form rider-form" data-price="" data-price-name=""><h4 class="guest-title">Guest '+r+' (Rider)</h4><input type="hidden" name="p15_guests.contact.'+r+'.isClient" value="true"><input type="hidden" id="bookedRiderPrice'+r+'" name="p15_guests.contact.'+r+'.p15_tripprices.1" value=""><input type="hidden" name="p15_guests.contact.'+r+'.samehousehold" value="false">\x3c!-- FIRST NAME --\x3e<div id="firstname-group" class="p15-input-group"><input type="text" class="p15-input-control" name="firstname" placeholder="First name..." oninput="clearError(this)">\x3c!-- errors will go here --\x3e</div>\x3c!-- LAST NAME --\x3e<div id="lastname-group" class="p15-input-group"><input type="text" class="p15-input-control" name="lastname" placeholder="Last name..." oninput="clearError(this)">\x3c!-- errors will go here --\x3e</div><div id="rider-fields'+r+'">\x3c!-- LICENSE --\x3e<div id="licensetype-group" class="p15-input-group"><label for="rideexp_motorcyclelicensetype" style="display:none">Motorcycle License Type <span style="color:red">*</span></label><select class="p15-input-control" name="rideexp_motorcyclelicensetype" oninput="clearError(this)"><option value="">License Type</option><option value="No License">No License</option><option value="Restricted">Restricted</option><option value="Unrestricted">Unrestricted</option></select></div>\x3c!-- errors will go here --\x3e\x3c!-- ROAD RIDING LEVEL --\x3e<div id="levelroad-group" class="p15-input-group"><label for="rideexp_roadridinglevel" style="display:none">Road Riding Level <span style="color:red">*</span></label><select class="p15-input-control" name="rideexp_roadridinglevel" oninput="clearError(this)"><option value="">Road Riding Level</option><option value="Beginner">Beginner</option><option value="Novice">Novice</option><option value="Competent">Competent</option><option value="Advanced">Advanced</option><option value="Valentino Rossi">Valentino Rossi</option></select></div>\x3c!-- errors will go here --\x3e\x3c!-- OFFROAD RIDING LEVEL --\x3e<div id="leveloffroad-group" class="p15-input-group"><label for="rideexp_offroadridinglevel" style="display:none">Off-Road Riding Level <span style="color:red">*</span></label><select class="p15-input-control" name="rideexp_offroadridinglevel" oninput="clearError(this)"><option value="">Off-Road Riding Level</option><option value="Beginner">Beginner</option><option value="Novice">Novice</option><option value="Competent">Competent</option><option value="Advanced">Advanced</option><option value="Graham Jarvis">Graham Jarvis</option></select></div>\x3c!-- errors will go here --\x3e\x3c!-- EXTRAS --\x3e<h4>Extras:</h4><div id="guestExtras'+r+'" class="p15-checkbox-group extras-area"></div></div></div>'),e(r,"rider"),t(),r++),c<r&&Q.html('<div class="p15-message p15-message-error"><small>Max number of guests reached for this tour.</small></div>'),a=jQuery('input[type="checkbox"]'),o()}),v.click(function(){r<=c&&(console.log("Counter: "+r+". Spots Left: "+c),j.append('<div id="guest'+r+'" class="guest-form pillion-form" data-price="" data-price-name=""><h4 class="guest-title">Guest '+r+' (Pillion)</h4><input type="hidden" name="p15_guests.contact.'+r+'.isClient" value="true"><input type="hidden" id="bookedPillionPrice'+r+'" class="cost-item-pillion" name="p15_guests.contact.'+r+'.p15_tripprices.1" value=""><input type="hidden" name="p15_guests.contact.'+r+'.samehousehold" value="false">\x3c!-- FIRST NAME --\x3e<div id="firstname-group" class="p15-input-group"><input type="text" class="p15-input-control" name="firstname" placeholder="First name..." oninput="clearError(this)">\x3c!-- errors will go here --\x3e</div>\x3c!-- LAST NAME --\x3e<div id="lastname-group" class="p15-input-group"><input type="text" class="p15-input-control" name="lastname" placeholder="Last name..." oninput="clearError(this)">\x3c!-- errors will go here --\x3e</div>\x3c!-- EXTRAS --\x3e<h4>Extras:</h4><div id="guestExtras'+r+'" class="p15-checkbox-group extras-area"></div></div>'),e(r,"pillion"),t(),r++),c<r&&Q.html('<div class="p15-message p15-message-error"><small>Max number of guests reached for this tour.</small></div>'),a=jQuery('input[type="checkbox"]'),o()})):"No"===s&&1<c?(R.html('<button class="p15-btn" type="button" id="addRider"><i class="fas fa-plus-square" style="margin-right:0.25rem;"></i> Add Rider</button>'),m=jQuery("#addRider"),r=2,m.click(function(){r<=c&&(console.log("Counter: "+r+". Spots Left: "+c),j.append('<div id="guest'+r+'" class="guest-form rider-form" data-price="" data-price-name=""><h4 class="guest-title">Guest '+r+' (Rider)</h4><input type="hidden" name="p15_guests.contact.'+r+'.isClient" value="true"><input type="hidden" id="bookedRiderPrice'+r+'" name="p15_guests.contact.'+r+'.p15_tripprices.1" value=""><input type="hidden" name="p15_guests.contact.'+r+'.samehousehold" value="false">\x3c!-- FIRST NAME --\x3e<div id="firstname-group" class="p15-input-group"><input type="text" class="p15-input-control" name="firstname" placeholder="First name..." oninput="clearError(this)">\x3c!-- errors will go here --\x3e</div>\x3c!-- LAST NAME --\x3e<div id="lastname-group" class="p15-input-group"><input type="text" class="p15-input-control" name="lastname" placeholder="Last name..." oninput="clearError(this)">\x3c!-- errors will go here --\x3e</div><div id="rider-fields'+r+'">\x3c!-- LICENSE --\x3e<div id="licensetype-group" class="p15-input-group"><label for="rideexp_motorcyclelicensetype" style="display:none">Motorcycle License Type <span style="color:red">*</span></label><select class="p15-input-control" name="rideexp_motorcyclelicensetype" oninput="clearError(this)"><option value="">License Type</option><option value="No License">No License</option><option value="Restricted">Restricted</option><option value="Unrestricted">Unrestricted</option></select></div>\x3c!-- errors will go here --\x3e\x3c!-- ROAD RIDING LEVEL --\x3e<div id="levelroad-group" class="p15-input-group"><label for="rideexp_roadridinglevel" style="display:none">Road Riding Level <span style="color:red">*</span></label><select class="p15-input-control" name="rideexp_roadridinglevel" oninput="clearError(this)"><option value="">Road Riding Level</option><option value="Beginner">Beginner</option><option value="Novice">Novice</option><option value="Competent">Competent</option><option value="Advanced">Advanced</option><option value="Valentino Rossi">Valentino Rossi</option></select></div>\x3c!-- errors will go here --\x3e\x3c!-- OFFROAD RIDING LEVEL --\x3e<div id="leveloffroad-group" class="p15-input-group"><label for="rideexp_offroadridinglevel" style="display:none">Off-Road Riding Level <span style="color:red">*</span></label><select class="p15-input-control" name="rideexp_offroadridinglevel" oninput="clearError(this)"><option value="">Off-Road Riding Level</option><option value="Beginner">Beginner</option><option value="Novice">Novice</option><option value="Competent">Competent</option><option value="Advanced">Advanced</option><option value="Graham Jarvis">Graham Jarvis</option></select></div>\x3c!-- errors will go here --\x3e\x3c!-- EXTRAS --\x3e<h4>Extras:</h4><div id="guestExtras'+r+'" class="p15-checkbox-group extras-area"></div></div></div>'),e(r,"rider"),r++),c<r&&Q.html('<div class="p15-message p15-message-error"><small>Max number of guests reached for this tour.</small></div>'),a=jQuery('input[type="checkbox"]'),o()})):Q.html('<div class="p15-message p15-message-warn"><small><b>Please Note:</b> This is the last spot available for this date.</small></div>'),""===g?y.css("display","none"):y.css("display","block")})}).fail(function(e){console.log("Error")})}),jQuery("#peak-15-form").submit(function(e){jQuery("#formNextSubmit").attr("disabled","disabled"),jQuery(".form-group").removeClass("p15-error"),jQuery(".p15-input-notif").remove(),console.log("Booking Form submitted.");var t={formname:jQuery("input[name=formname]").val(),pagename:jQuery("input[name=pagename]").val(),statuscode:jQuery("input[name=statuscode]").val(),rule:jQuery("input[name=rule]").val(),ruletype:jQuery("input[name=ruletype]").val(),contacttype:jQuery("input[name=contacttype]").val(),action:jQuery("input[name=action]").val(),firstname:jQuery("input[name=firstname]").val(),lastname:jQuery("input[name=lastname]").val(),email:jQuery("input[name=email]").val(),telephone1:jQuery("input[name=telephone1]").val(),rideexp_motorcyclelicensetype:jQuery("select[name=rideexp_motorcyclelicensetype]").val(),rideexp_licenseheldsince:jQuery("input[name=rideexp_licenseheldsince]").val(),rideexp_roadridinglevel:jQuery("select[name=rideexp_roadridinglevel]").val(),rideexp_offroadridinglevel:jQuery("select[name=rideexp_offroadridinglevel]").val()};console.log(t),jQuery.ajax({type:"POST",url:r,data:t,dataType:"json",encode:!0}).done(function(e){console.log(e),e.success?jQuery("#peak-15-form").html('<div class="p15-message p15-message-success">'+e.message+"</div>"):(jQuery("#formNextSubmit").removeAttr("disabled","disabled"),e.errors.validation&&jQuery("#peak-15-form").html('<div class="p15-message p15-message-error"><b>'+e.errors.validation+"</b><br>"+e.message+"</div>"),e.errors.firstname&&(jQuery("#firstname-group").addClass("p15-error"),jQuery("#firstname-group").append('<div class="p15-input-notif"><small>'+e.errors.firstname+"</small></div>")),e.errors.lastname&&(jQuery("#lastname-group").addClass("p15-error"),jQuery("#lastname-group").append('<div class="p15-input-notif"><small>'+e.errors.lastname+"</small></div>")),e.errors.email&&(jQuery("#email-group").addClass("p15-error"),jQuery("#email-group").append('<div class="p15-input-notif"><small>'+e.errors.email+"</small></div>")),e.errors.telephone1&&(jQuery("#phone-group").addClass("p15-error"),jQuery("#phone-group").append('<div class="p15-input-notif"><small>'+e.errors.telephone1+"</small></div>")),e.errors.p15_groupsize&&(jQuery("#groupsize-group").addClass("p15-error"),jQuery("#groupsize-group").append('<div class="p15-input-notif"><small>'+e.errors.p15_groupsize+"</small></div>")),e.errors.rideexp_motorcyclelicensetype&&(jQuery("#licensetype-group").addClass("p15-error"),jQuery("#licensetype-group").append('<div class="p15-input-notif"><small>'+e.errors.rideexp_motorcyclelicensetype+"</small></div>")),e.errors.rideexp_licenseheldsince&&(jQuery("#licensesince-group").addClass("p15-error"),jQuery("#licensesince-group").append('<div class="p15-input-notif"><small>'+e.errors.rideexp_licenseheldsince+"</small></div>")),e.errors.rideexp_roadridinglevel&&(jQuery("#levelroad-group").addClass("p15-error"),jQuery("#levelroad-group").append('<div class="p15-input-notif"><small>'+e.errors.rideexp_roadridinglevel+"</small></div>")),e.errors.rideexp_offroadridinglevel&&(jQuery("#leveloffroad-group").addClass("p15-error"),jQuery("#leveloffroad-group").append('<div class="p15-input-notif"><small>'+e.errors.rideexp_offroadridinglevel+"</small></div>")))}).fail(function(e){jQuery("#peak-15-form").html('<div class="p15-message p15-message-error">Sorry, your form was not sent, please try again later.</div>')}),e.preventDefault()})})},{}]},{},[1]);
//# sourceMappingURL=peak15link-ajax-bookings.min.js.map
